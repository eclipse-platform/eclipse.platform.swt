<!-- ============================================================================= -->
<!-- Copyright (c) 2000, 2002 IBM Corp.  All rights reserved.                      -->
<!-- This file is made available under the terms of the Common Public License v1.0 -->
<!-- which accompanies this distribution, and is available at                      -->
<!-- http://www.eclipse.org/legal/cpl-v10.html                                     -->
<!--                                                                               -->
<!-- Andre Weinand, OTI - Initial version                                          -->
<!-- ============================================================================= --> 

<project default="export" basedir=".">

	<target name="init">
		<tstamp/>
        <property name="destdir" value="../../../../../export" />
		<property name="plugin" value="org.eclipse.swt" />
		<property name="maj_ver" value="2" />
		<property name="min_ver" value="104" />
        <mkdir dir="${destdir}" />
	</target>

	<target name="build" depends="init">
    	<eclipse.incrementalBuild project="${plugin}" kind="incr" />
	</target>
	
	<target name="build_header" depends="build">
 		<javah
 			destdir="."
 			force="yes"
 			classpath="../../../bin"
  			class= "org.eclipse.swt.internal.carbon.OS"
		/>
	</target>

	<target name="build_dll" depends="build_header">
	
		<property name="SWT_VERSION" value="${maj_ver}${min_ver}" />
		<property name="SWT_PREFIX" value="swt" />
		<property name="WS_PREFIX" value="carbon" />
		<property name="SWT_DLL" value="lib${SWT_PREFIX}-${WS_PREFIX}-${SWT_VERSION}.jnilib" />
		
		<exec executable="cc">
  			<arg line="-bundle" />
  			<arg value='-DPLATFORM="carbon"' />
  			<arg value="-DREDUCED_CALLBACKS=1" />
  			<arg line="-I /System/Library/Frameworks/JavaVM.framework/Headers" />
  			<arg line="-o ${destdir}/${SWT_DLL}" />
  			<arg line="-framework JavaVM" />
  			<arg line="-framework Carbon" />
  			<arg line="swt.c" />
 			<arg value="../../../Eclipse SWT/common/library/callback.c" />
		</exec>
		
	</target>
		
    <target name="build_jar" depends="build">
        <jar
            jarfile="${destdir}/swt.jar"
            basedir="../../../bin"
        />
    </target>

    <target name="export" depends="build_jar,build_dll">
    </target>
	
</project>
